import { useTheme } from "styled-components/native";
import { ListItemType } from "../model/list";
import { centsToReais } from "@/src/utils/convertCurrency";

export const useBuildPDFTemplate = () => {
  const theme = useTheme();

  const buildHtmlPDFTemplate = (
    listName: string,
    itemsList: ListItemType[],
    listTotalPrice: number
  ) => {
    const html = `
      <html>
          <body>
  
            <style>
                body{
                    margin: 0;
                    padding: 0;
                }
                .pdf__container{
                  display: flex;
                  flex-direction: column;
                  justify-content: space-between;
                  height: 100%;
                }
                .pdf__content{
                  padding: 15px;
                }
                .pdf__header{
                    display: flex;
                    flex-direction: row;
                    align-items: center;
                    justify-content: space-between;
                    background-color: ${theme.secondaryColor};
                    padding: 15px;
                    margin-bottom: 20px;
                }
                .pdf__header h1{
                    font-size: 24px;
                    color: ${theme.primaryColor};
                    text-align: right;
                    margin: 0;
                }
                .pdf__content h2{
                    font-size: 20px;
                    color: ${theme.textColor};
                    font-weight: bold;
                }
                .pdf__item_wrapper{
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    background-color: ${theme.secondaryColor};
                    margin: 5px 0;
                    border-radius: ${theme.defaultBorderRadius};
                    overflow: hidden;
                }
                .pdf__item_title{
                    font-size: 14px;
                    color: white;
                    font-weight: 400;
                    flex: 1;
                    padding: 15px;
                }
                .pdf__item_price{
                    font-size: 14px;
                    color: ${theme.primaryColor};
                    background-color: ${theme.secondaryColor};
                    font-weight: bold;
                    padding: 15px;
                    width: 20%;
                    text-align: right;  
                }
                footer{
                    background-color: ${theme.secondaryColor};
                    padding: 15px;  
                    color: white;
                    font-size: 12px;
                    text-align: center;
                }
                footer a{
                    text-decoration: none;
                    color: ${theme.primaryColor};
                    font-size: 12px;
                    text-align: center;
                }
            </style>
  
            <div class="pdf__container">
                <div class="pdf__header">
                    <svg width="167" height="63" viewBox="0 0 167 63" fill="none">
                      <path
                        d="M9.59083 37.9297C9.59083 39.0506 9.73494 39.8672 10.0232 40.3796C10.3114 40.892 10.7758 41.1482 11.4163 41.1482C11.8006 41.1482 12.1688 41.1162 12.5211 41.0521C12.9054 40.9881 13.3698 40.844 13.9142 40.6198L14.5867 45.5196C14.0743 45.7758 13.2897 46.032 12.2329 46.2882C11.1761 46.5444 10.0872 46.6725 8.96634 46.6725C7.14092 46.6725 5.74783 46.2562 4.78708 45.4236C3.82633 44.5589 3.34596 43.1498 3.34596 41.1963V12.3738H9.59083V37.9297ZM17.8506 21.9813H24.0955V46H17.8506V21.9813ZM16.9379 15.208C16.9379 14.2793 17.2742 13.4947 17.9467 12.8541C18.6513 12.1816 19.612 11.8454 20.829 11.8454C22.0459 11.8454 23.0227 12.1816 23.7593 12.8541C24.5279 13.4947 24.9122 14.2793 24.9122 15.208C24.9122 16.1367 24.5279 16.9213 23.7593 17.5618C23.0227 18.1703 22.0459 18.4745 20.829 18.4745C19.612 18.4745 18.6513 18.1703 17.9467 17.5618C17.2742 16.9213 16.9379 16.1367 16.9379 15.208ZM40.1186 39.3708C40.1186 38.7303 39.8464 38.2179 39.302 37.8336C38.7576 37.4493 38.085 37.0971 37.2844 36.7768C36.4838 36.4566 35.6031 36.1363 34.6424 35.8161C33.6816 35.4638 32.8009 34.9994 32.0003 34.423C31.1997 33.8145 30.5272 33.0619 29.9827 32.1652C29.4383 31.2365 29.1661 30.0516 29.1661 28.6104C29.1661 26.2406 29.8706 24.4312 31.2797 23.1822C32.6888 21.9332 34.7224 21.3087 37.3805 21.3087C39.2059 21.3087 40.8552 21.5009 42.3284 21.8852C43.8015 22.2695 44.9544 22.7018 45.7871 23.1822L44.394 27.6977C43.6574 27.4095 42.7287 27.1053 41.6078 26.785C40.4869 26.4648 39.35 26.3046 38.1971 26.3046C36.3397 26.3046 35.411 27.0252 35.411 28.4663C35.411 29.0428 35.6832 29.5071 36.2276 29.8594C36.772 30.2117 37.4445 30.5479 38.2452 30.8682C39.0458 31.1564 39.9265 31.4767 40.8872 31.8289C41.848 32.1812 42.7287 32.6456 43.5293 33.222C44.3299 33.7665 45.0024 34.487 45.5469 35.3837C46.0913 36.2804 46.3635 37.4333 46.3635 38.8424C46.3635 41.2763 45.5789 43.1978 44.0097 44.6069C42.4725 45.984 40.1507 46.6725 37.0442 46.6725C35.3469 46.6725 33.7457 46.4483 32.2405 46C30.7673 45.5837 29.5664 45.0873 28.6377 44.5108L30.367 39.8512C31.1036 40.2675 32.0804 40.6839 33.2973 41.1002C34.5143 41.4845 35.7632 41.6766 37.0442 41.6766C37.973 41.6766 38.7095 41.5005 39.254 41.1482C39.8304 40.7959 40.1186 40.2035 40.1186 39.3708ZM47.9427 21.9813H51.2573V17.4657L57.5022 15.6884V21.9813H63.3628V27.2654H57.5022V36.4886C57.5022 38.1539 57.6623 39.3548 57.9826 40.0914C58.3348 40.7959 58.9753 41.1482 59.9041 41.1482C60.5446 41.1482 61.089 41.0842 61.5373 40.9561C62.0177 40.828 62.5461 40.6358 63.1226 40.3796L64.2274 45.1834C63.3628 45.5997 62.354 45.952 61.2011 46.2402C60.0482 46.5284 58.8793 46.6725 57.6943 46.6725C55.4846 46.6725 53.8513 46.1121 52.7945 44.9912C51.7697 43.8383 51.2573 41.9649 51.2573 39.3708V27.2654H47.9427V21.9813ZM67.3322 12.3738H87.2678V18.2343H73.9134V26.0645H86.0668V31.925H73.9134V40.1394H87.508V46H67.3322V12.3738ZM92.1417 23.3744C93.4227 22.7979 94.9439 22.3496 96.7053 22.0293C98.4666 21.677 100.308 21.5009 102.23 21.5009C103.895 21.5009 105.288 21.7091 106.409 22.1254C107.53 22.5097 108.41 23.0701 109.051 23.8067C109.723 24.5433 110.188 25.424 110.444 26.4488C110.732 27.4736 110.876 28.6265 110.876 29.9075C110.876 31.3165 110.828 32.7417 110.732 34.1828C110.636 35.5919 110.572 36.985 110.54 38.362C110.54 39.7391 110.588 41.0842 110.684 42.3972C110.78 43.6782 111.02 44.8951 111.405 46.048H106.313L105.304 42.7335H105.064C104.423 43.7262 103.527 44.5909 102.374 45.3275C101.253 46.032 99.7957 46.3843 98.0023 46.3843C96.8814 46.3843 95.8726 46.2242 94.9759 45.9039C94.0792 45.5517 93.3106 45.0713 92.6701 44.4628C92.0296 43.8223 91.5332 43.0857 91.1809 42.2531C90.8287 41.3884 90.6525 40.4277 90.6525 39.3708C90.6525 37.8977 90.9728 36.6647 91.6133 35.6719C92.2858 34.6471 93.2305 33.8305 94.4475 33.222C95.6965 32.5815 97.1696 32.1492 98.8669 31.925C100.596 31.6688 102.518 31.5888 104.631 31.6848C104.856 29.8914 104.728 28.6104 104.247 27.8418C103.767 27.0412 102.694 26.6409 101.029 26.6409C99.7797 26.6409 98.4506 26.769 97.0415 27.0252C95.6644 27.2814 94.5276 27.6177 93.6309 28.034L92.1417 23.3744ZM100.068 41.2443C101.317 41.2443 102.31 40.9721 103.046 40.4277C103.783 39.8512 104.327 39.2427 104.679 38.6022V35.4798C103.687 35.3837 102.726 35.3677 101.797 35.4318C100.901 35.4958 100.1 35.6399 99.3954 35.8641C98.6908 36.0883 98.1304 36.4085 97.714 36.8248C97.2977 37.2412 97.0896 37.7696 97.0896 38.4101C97.0896 39.3068 97.3458 40.0113 97.8582 40.5237C98.4026 41.0041 99.1392 41.2443 100.068 41.2443ZM126.061 39.3708C126.061 38.7303 125.788 38.2179 125.244 37.8336C124.7 37.4493 124.027 37.0971 123.226 36.7768C122.426 36.4566 121.545 36.1363 120.584 35.8161C119.624 35.4638 118.743 34.9994 117.942 34.423C117.142 33.8145 116.469 33.0619 115.925 32.1652C115.38 31.2365 115.108 30.0516 115.108 28.6104C115.108 26.2406 115.813 24.4312 117.222 23.1822C118.631 21.9332 120.664 21.3087 123.323 21.3087C125.148 21.3087 126.797 21.5009 128.27 21.8852C129.744 22.2695 130.896 22.7018 131.729 23.1822L130.336 27.6977C129.599 27.4095 128.671 27.1053 127.55 26.785C126.429 26.4648 125.292 26.3046 124.139 26.3046C122.282 26.3046 121.353 27.0252 121.353 28.4663C121.353 29.0428 121.625 29.5071 122.17 29.8594C122.714 30.2117 123.387 30.5479 124.187 30.8682C124.988 31.1564 125.869 31.4767 126.829 31.8289C127.79 32.1812 128.671 32.6456 129.471 33.222C130.272 33.7665 130.944 34.487 131.489 35.3837C132.033 36.2804 132.306 37.4333 132.306 38.8424C132.306 41.2763 131.521 43.1978 129.952 44.6069C128.414 45.984 126.093 46.6725 122.986 46.6725C121.289 46.6725 119.688 46.4483 118.183 46C116.709 45.5837 115.508 45.0873 114.58 44.5108L116.309 39.8512C117.046 40.2675 118.022 40.6839 119.239 41.1002C120.456 41.4845 121.705 41.6766 122.986 41.6766C123.915 41.6766 124.652 41.5005 125.196 41.1482C125.772 40.7959 126.061 40.2035 126.061 39.3708ZM145.126 35.4798L145.99 39.2267H146.278L146.903 35.4318L150.554 21.9813H156.991L149.689 43.6462C149.081 45.4396 148.488 47.0728 147.912 48.546C147.367 50.0512 146.759 51.3482 146.086 52.437C145.414 53.5259 144.661 54.3585 143.829 54.935C143.028 55.5434 142.067 55.8477 140.946 55.8477C139.281 55.8477 137.952 55.5755 136.959 55.031L138.112 50.0351C138.592 50.2273 139.073 50.3234 139.553 50.3234C140.29 50.3234 140.994 50.0031 141.667 49.3626C142.371 48.7541 142.9 47.6333 143.252 46L133.212 21.9813H140.706L145.126 35.4798Z"
                        fill=${theme.primaryColor}
                      />
                      <circle
                        cx="5.47833"
                        cy="5.47833"
                        r="5.47833"
                        transform="matrix(1 0 0 -1 155.168 45.8951)"
                        fill=${theme.primaryColor}
                      />
                    </svg>
                    <h1>${listName}</h1>
                </div>  
                
                <div class="pdf__content">
                    <h2>Lista de itens</h2>

                      ${itemsList
                        ?.map(
                          (item) =>
                            `<div class="pdf__item_wrapper">
                              <span class="pdf__item_title">${
                                item.name
                              }</span>                        
                              <span class="pdf__item_price">R$ ${centsToReais(
                                item.price
                              ).toFixed(2)}</span>
                          </div>`
                        )
                        .join("")}   
                    
                      <div class="pdf__item_wrapper">
                          <span class="pdf__item_title">Total:</span>                        
                          <span class="pdf__item_price">R$ ${centsToReais(
                            listTotalPrice
                          ).toFixed(2)}</span>
                      </div>
                </div>
  
                <div style="flex: 1"></div>
  
                <footer>
                    <a href="https://play.google.com/store/apps/details?id=com.penpack.listeasy">Disponível para Android na PlayStore.</a>
                </footer>
            </div>
          </body>
      </html>
      `;

    return html;
  };

  return {
    buildHtmlPDFTemplate,
  };
};
